{"ast":null,"code":"import _slicedToArray from\"/Users/kirillchistov/Projects/movies-explorer-frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";//  Компонент профиля  //\nimport React,{useEffect,useState,useContext}from'react';import{CurrentUserContext}from'../../contexts/CurrentUserContext';import useFormWithValidation from'../../hooks/useFormWithValidation';import Header from'../Header/Header';import'./Profile.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Profile=function Profile(_ref){var loggedIn=_ref.loggedIn,onSignOut=_ref.onSignOut,onUpdateProfile=_ref.onUpdateProfile,requestEditProfileError=_ref.requestEditProfileError;var currentUser=useContext(CurrentUserContext);var _useFormWithValidatio=useFormWithValidation(''),values=_useFormWithValidatio.values,handleChange=_useFormWithValidatio.handleChange,errors=_useFormWithValidatio.errors,isValid=_useFormWithValidatio.isValid,resetForm=_useFormWithValidatio.resetForm;var _useState=useState(true),_useState2=_slicedToArray(_useState,2),isInputDisabled=_useState2[0],setIsInputDisabled=_useState2[1];var _useState3=useState(true),_useState4=_slicedToArray(_useState3,2),isSubmitDisabled=_useState4[0],setIsSubmitDisabled=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isEdit=_useState6[0],setIsEdit=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),isRequestError=_useState8[0],setIsRequestError=_useState8[1];var _useState9=useState(''),_useState10=_slicedToArray(_useState9,2),messageRequestError=_useState10[0],setMesageRequestError=_useState10[1];var handleEditProfile=function handleEditProfile(){resetForm(currentUser,{},false);setIsRequestError(false);setMesageRequestError('');setIsInputDisabled(false);setIsEdit(!isEdit);};var handleSubmit=function handleSubmit(evt){evt.preventDefault();setIsRequestError(false);setMesageRequestError('');setIsInputDisabled(true);setIsSubmitDisabled(true);var newValues={name:values.name===undefined?currentUser.name:values.name,email:values.email===undefined?currentUser.email:values.email};onUpdateProfile(newValues);setIsEdit(!isEdit);resetForm(newValues,{},false);};useEffect(function(){setIsSubmitDisabled(isValid&&(values.name!==currentUser.name||values.email!==currentUser.email));},[values.name,values.email,isValid,currentUser.name,currentUser.email]);useEffect(function(){setIsRequestError(requestEditProfileError.isRequestError);setMesageRequestError(requestEditProfileError.messageRequestError);},[requestEditProfileError]);useEffect(function(){setIsRequestError(false);setMesageRequestError('');},[]);return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Header,{loggedIn:loggedIn}),/*#__PURE__*/_jsxs(\"section\",{className:\"profile\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"profile__title\",children:\"\\u041F\\u0440\\u0438\\u0432\\u0435\\u0442, \".concat(currentUser.name,\"!\")}),/*#__PURE__*/_jsxs(\"form\",{className:\"profile__form\",name:\"profile\",onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"profile__list\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"profile__item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"profile__caption\",children:\"\\u0418\\u043C\\u044F\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"name\",name:\"name\",required:true,minLength:\"2\",maxLength:\"40\",onChange:handleChange,value:values.name||currentUser.name,disabled:isInputDisabled,className:\"\".concat(errors.name?'profile__input profile__input_active':'profile__input')})]}),/*#__PURE__*/_jsx(\"span\",{className:\"\".concat(errors.name?'profile__error_active profile__input_error':'profile__input_error'),children:errors.name}),/*#__PURE__*/_jsxs(\"div\",{className:\"profile__item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"profile__caption\",children:\"E-mail\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",id:\"email\",name:\"email\",pattern:\"[a-z0-9._%+-]+@[a-z0-9.-]+\\\\.[a-z]{2,4}$\",title:\"\\u042D\\u0442\\u043E \\u043D\\u0435\\u043F\\u043E\\u043B\\u043D\\u044B\\u0439 \\u0430\\u0434\\u0440\\u0435\\u0441 email\",required:true,onChange:handleChange,value:values.email||currentUser.email,disabled:isInputDisabled,className:\"\".concat(errors.email?'profile__input profile__input_active':'profile__input')})]}),/*#__PURE__*/_jsx(\"span\",{className:\"\".concat(errors.email?'profile__error_active profile__input_error':'profile__input_error'),children:errors.email})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"profile__submit\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"\".concat(isRequestError?'profile__error profile__error_active':'profile__error'),children:messageRequestError}),isEdit?/*#__PURE__*/_jsx(\"button\",{className:'profile__button profile__button_submit button '+(!isSubmitDisabled?'':'link'),type:\"submit\",onClick:handleSubmit,disabled:!isSubmitDisabled,children:\"\\u0421\\u043E\\u0445\\u0440\\u0430\\u043D\\u0438\\u0442\\u044C\"}):/*#__PURE__*/_jsx(\"button\",{className:\"profile__button link profile__button_edit button\",type:\"button\",onClick:handleEditProfile,children:\"\\u0420\\u0435\\u0434\\u0430\\u043A\\u0442\\u0438\\u0440\\u043E\\u0432\\u0430\\u0442\\u044C\"}),/*#__PURE__*/_jsx(\"button\",{className:\"profile__button link profile__button_signout button\",type:\"button\",onClick:onSignOut,children:\"\\u0412\\u044B\\u0439\\u0442\\u0438 \\u0438\\u0437 \\u0430\\u043A\\u043A\\u0430\\u0443\\u043D\\u0442\\u0430\"})]})]})]})]});};export default Profile;","map":{"version":3,"names":["React","useEffect","useState","useContext","CurrentUserContext","useFormWithValidation","Header","Profile","loggedIn","onSignOut","onUpdateProfile","requestEditProfileError","currentUser","values","handleChange","errors","isValid","resetForm","isInputDisabled","setIsInputDisabled","isSubmitDisabled","setIsSubmitDisabled","isEdit","setIsEdit","isRequestError","setIsRequestError","messageRequestError","setMesageRequestError","handleEditProfile","handleSubmit","evt","preventDefault","newValues","name","undefined","email"],"sources":["/Users/kirillchistov/Projects/movies-explorer-frontend/src/components/Profile/Profile.jsx"],"sourcesContent":["//  Компонент профиля  //\nimport React, { useEffect, useState, useContext } from 'react';\nimport { CurrentUserContext } from '../../contexts/CurrentUserContext';\nimport useFormWithValidation from '../../hooks/useFormWithValidation';\n\nimport Header from '../Header/Header';\nimport './Profile.css';\n\nconst Profile = ({\n  loggedIn,\n  onSignOut,\n  onUpdateProfile,\n  requestEditProfileError,\n}) => {\n  const currentUser = useContext(CurrentUserContext);\n  const { values, handleChange, errors, isValid, resetForm } = useFormWithValidation('');\n\n  const [isInputDisabled, setIsInputDisabled] = useState(true);\n  const [isSubmitDisabled, setIsSubmitDisabled] = useState(true);\n\n  const [isEdit, setIsEdit] = useState(false);\n\n  const [isRequestError, setIsRequestError] = useState(false);\n  const [messageRequestError, setMesageRequestError] = useState('');\n\n  const handleEditProfile = () => {\n    resetForm(currentUser, {}, false);\n    setIsRequestError(false);\n    setMesageRequestError('');\n    setIsInputDisabled(false);\n    setIsEdit(!isEdit);\n  }\n\n  const handleSubmit = (evt) => {\n    evt.preventDefault();\n    setIsRequestError(false);\n    setMesageRequestError('');\n    setIsInputDisabled(true);\n    setIsSubmitDisabled(true);\n    const newValues = {\n      name: values.name === undefined ? currentUser.name : values.name,\n      email: values.email === undefined ? currentUser.email : values.email,\n    };\n    onUpdateProfile(newValues);\n    setIsEdit(!isEdit);\n    resetForm(newValues, {}, false);\n  }\n\n  useEffect(() => {\n    setIsSubmitDisabled(\n      isValid &&\n        (values.name !== currentUser.name ||\n          values.email !== currentUser.email),\n    );\n  }, [values.name, values.email, isValid, currentUser.name, currentUser.email]);\n\n  useEffect(() => {\n    setIsRequestError(requestEditProfileError.isRequestError);\n    setMesageRequestError(requestEditProfileError.messageRequestError);\n  }, [requestEditProfileError]);\n\n  useEffect(() => {\n    setIsRequestError(false);\n    setMesageRequestError('');\n  }, []);\n\n  return (\n    <>\n      <Header loggedIn={loggedIn} />\n      <section className='profile'>\n        <h2 className='profile__title'>{`Привет, ${currentUser.name}!`}</h2>\n        <form className='profile__form' name='profile' onSubmit={handleSubmit}>\n          <div className='profile__list'>\n            <div className='profile__item'>\n              <span className='profile__caption'>Имя</span>\n              <input\n                type='text'\n                id='name'\n                name='name'\n                required\n                minLength='2'\n                maxLength='40'\n                onChange={handleChange}\n                value={values.name || currentUser.name}\n                disabled={isInputDisabled}\n                className={`${\n                  errors.name\n                    ? 'profile__input profile__input_active'\n                    : 'profile__input'\n                }`}\n              />\n            </div>\n            <span\n              className={`${\n                errors.name\n                  ? 'profile__error_active profile__input_error'\n                  : 'profile__input_error'\n              }`}\n            >\n              {errors.name}\n            </span>\n            <div className='profile__item'>\n              <span className='profile__caption'>E-mail</span>\n              <input\n                type='email'\n                id='email'\n                name='email'\n                pattern='[a-z0-9._%+-]+@[a-z0-9.-]+\\.[a-z]{2,4}$'\n                title='Это неполный адрес email'\n                required\n                onChange={handleChange}\n                value={values.email || currentUser.email}\n                disabled={isInputDisabled}\n                className={`${\n                  errors.email\n                    ? 'profile__input profile__input_active'\n                    : 'profile__input'\n                }`}\n              />\n            </div>\n            <span\n              className={`${\n                errors.email\n                  ? 'profile__error_active profile__input_error'\n                  : 'profile__input_error'\n              }`}\n            >\n              {errors.email}\n            </span>\n          </div>\n          <div className='profile__submit'>\n            <span\n              className={`${\n                isRequestError\n                  ? 'profile__error profile__error_active'\n                  : 'profile__error'\n              }`}\n            >\n              {messageRequestError}\n            </span>\n            {isEdit ? (\n              <button\n                className={\n                  'profile__button profile__button_submit button ' +\n                  (!isSubmitDisabled ? '' : 'link')\n                }\n                type='submit'\n                onClick={handleSubmit}\n                disabled={!isSubmitDisabled}\n              >\n                Сохранить\n              </button>\n            ) : (\n              <button\n                className='profile__button link profile__button_edit button'\n                type='button'\n                onClick={handleEditProfile}\n              >\n                Редактировать\n              </button>\n            )}\n\n            <button\n              className='profile__button link profile__button_signout button'\n              type='button'\n              onClick={onSignOut}\n            >\n              Выйти из аккаунта\n            </button>\n          </div>\n        </form>\n      </section>\n    </>\n  );\n}\n\nexport default Profile;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}